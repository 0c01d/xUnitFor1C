&НаКлиенте
Перем ПостроительДереваТестов;
&НаКлиенте
Перем ИконкиУзловДереваТестов;
&НаКлиенте
Перем ЗагрузчикФайла;

// { Plugin interface
&НаКлиенте
Функция ОписаниеПлагина(ВозможныеТипыПлагинов) Экспорт
	Возврат ОписаниеПлагинаНаСервере(ВозможныеТипыПлагинов);
КонецФункции

&НаСервере
Функция ОписаниеПлагинаНаСервере(ВозможныеТипыПлагинов)
	Возврат ЭтотОбъектНаСервере().ОписаниеПлагина(ВозможныеТипыПлагинов);
КонецФункции
// } Plugin interface

// { Loader interface
&НаКлиенте
Функция ВыбратьПутьИнтерактивно(ТекущийПуть = "") Экспорт
	Перем ВыбранныйПуть;
	
	ПараметрыОткрытия = Новый Структура("ОтборПоИмениТеста", "");
	ИмяФормыВыбораПодсистемыУФ = СтрЗаменить(ЭтаФорма.ИмяФормы, "УправляемаяФорма", "ФормаВыбораПодсистемУФ");
	ВыбранныйПуть = ОткрытьФормуМодально(ИмяФормыВыбораПодсистемыУФ, ПараметрыОткрытия, ЭтаФорма);
	
	Возврат ВыбранныйПуть;
КонецФункции

&НаКлиенте
Функция Загрузить(КонтекстЯдра, Путь) Экспорт
	ДеревоТестов = ЗагрузитьНаСервере(Путь);
	
	Возврат ДеревоТестов;
КонецФункции

&НаКлиенте
Функция ПолучитьКонтекстПоПути(КонтекстЯдра, Путь) Экспорт
	Контекст = ПолучитьКонтекстПоПутиНаСервере(Путь);
	
	Возврат Контекст;
КонецФункции
// } Loader interface

&НаСервере
Функция ЗагрузитьНаСервере(Путь)
	ПостроительДереваТестов = ВнешниеОбработки.Создать("ПостроительДереваТестов");
	ЗагрузчикФайла = ВнешниеОбработки.Создать("ЗагрузчикФайла");
	ДеревоТестов = ЭтотОбъектНаСервере().ЗагрузитьПуть(Путь, ПостроительДереваТестов, ЗагрузчикФайла);
	
	Возврат ДеревоТестов;
КонецФункции

&НаСервере
Функция ПолучитьКонтекстПоПутиНаСервере(Путь)
	ОбъектМетаданных = ЭтотОбъектНаСервере().ПолучитьОбъектМетаданныхПоПути(Путь);
	Результат = Новый Структура("ЭтоВнутренняяОбработка, Имя", Истина, ОбъектМетаданных.Имя);
	
	Возврат Результат;
КонецФункции

// { Helpers
&НаСервере
Функция ЭтотОбъектНаСервере()
	Возврат РеквизитФормыВЗначение("Объект");
КонецФункции
// } Helpers
